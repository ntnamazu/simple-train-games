services:
  game:
    image: nginx:alpine
    ports:
      - "8080:80"
    volumes:
      - .:/usr/share/nginx/html:ro

  test:
    image: mcr.microsoft.com/playwright:v1.40.0-jammy
    working_dir: /app
    volumes:
      - .:/app
    depends_on:
      - game
    command: >
      bash -c "
        npm install &&
        npx playwright install chromium &&
        npx playwright test --reporter=list
      "
    environment:
      - CI=true
